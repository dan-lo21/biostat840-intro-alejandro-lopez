sets <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-09-06/sets.csv.gz')
themes <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-09-06/themes.csv.gz')
saveRDS(sets, file = here("data","sets.RDS"))
saveRDS(sets, file = here("data","sets.RDS"))
library(ggplot2)
library(dplyr)
library(here)
library(forcats)
library(data.table)
library(patchwork)
library(stringr)
saveRDS(sets, file = here("data","sets.RDS"))
saveRDS(themes, file = here("data","themes.RDS"))
sets <- readRDS(here("data","sets.RDS"))
themes <- readRDS(here("data","themes.RDS"))
sets <- sets %>% select('set_num', 'name', 'year', 'theme_id', 'num_parts')
colnames(themes) <- c('theme_id', 'theme_name', 'parent_id')
themes <- themes %>% select('theme_id', 'theme_name')
with_theme <- inner_join(sets, themes, by='theme_id')
most_pieces <- with_theme %>% filter(year >= 1997, num_parts > 10) %>% group_by(theme_name) %>% summarize(sum=sum(num_parts)) %>% arrange(-sum) %>% head(12)
most_pieces
most_popular_pieces <- unlist(most_pieces[['theme_name']])
most_sets <- with_theme %>% filter(year>=1997, num_parts > 12) %>% group_by(theme_name) %>% summarize(n=n()) %>% arrange(-n) %>% head(12)
most_sets
x <- seq(1, 12)
most_pieces$ranking <- x
most_sets$ranking <- x
ranked <- inner_join(most_pieces, most_sets, 'ranking') %>% select('ranking', 'theme_name.x', 'theme_name.y') %>% setnames(new=c('ranking', 'theme_name_pieces', 'theme_name_sets'), old=c('ranking', 'theme_name.x', 'theme_name.y'))
ranked
with_theme %>% filter(year >= 1997, num_parts > 10) %>% group_by(year) %>% summarize(avg = mean(num_parts)) %>% ggplot(aes(year, avg)) + geom_line() + labs(x='Year', y='Average Number of Pieces', title='Average Number of Pieces in Last 25 Years', subtitle="Average number of pieces has increased in the last 25 years.")
with_theme %>% filter(year >= 1997, num_parts > 10) %>% group_by(year) %>% summarize(n = n()) %>% ggplot(aes(year, n)) + geom_line() + labs(x='Year', y='Number of Sets', title='Number of Sets in Last 25 Years', subtitle="Number of sets has increased in the last 25 years.")
